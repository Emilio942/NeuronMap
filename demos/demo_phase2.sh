#!/bin/bash

# NeuronMap Phase 2 Enhancement Demo
# This script demonstrates the new features implemented in Phase 2

echo "ğŸ¯ NeuronMap Phase 2 Enhancement Demo"
echo "======================================"

echo ""
echo "ğŸ“Š 1. Data Processing and Quality Management"
echo "-------------------------------------------"

echo "# Process a questions file with quality validation"
echo "python main.py process --input-file data/raw/questions.jsonl \\"
echo "                       --output-file data/processed/validated_questions.h5 \\"
echo "                       --validate --async-mode --chunk-size 500 \\"
echo "                       --experiment-name 'quality_demo'"

echo ""
echo "# Validate data quality and detect duplicates"
echo "python main.py validate-data --input-file data/raw/questions.jsonl \\"
echo "                            --duplicate-threshold 0.85"

echo ""
echo "# Manage experiment metadata"
echo "python main.py metadata --action list-experiments"
echo "python main.py metadata --action create-version \\"
echo "                        --dataset-name 'demo_questions' \\"
echo "                        --file-path data/raw/questions.jsonl \\"
echo "                        --description 'Demo dataset for Phase 2'"

echo ""
echo "ğŸ¨ 2. Interactive Visualizations"
echo "--------------------------------"

echo "# Create comprehensive interactive dashboard"
echo "python main.py interactive --input-file data/outputs/activations.h5 \\"
echo "                          --dashboard \\"
echo "                          --output-dir data/outputs/interactive_dashboard"

echo ""
echo "# Create specific interactive visualizations"
echo "python main.py interactive --input-file data/outputs/activations.h5 \\"
echo "                          --types heatmap dimensionality distribution \\"
echo "                          --layer 'transformer.layers.0' \\"
echo "                          --dim-method umap --show-clusters"

echo ""
echo "# Create animated layer progression"
echo "python main.py interactive --input-file data/outputs/activations.h5 \\"
echo "                          --types animation \\"
echo "                          --output-dir data/outputs/animations"

echo ""
echo "âš¡ 3. Enhanced Multi-Model Extraction with Performance Optimization"
echo "===================================================================="

echo "# Extract activations from multiple layers with optimized processing"
echo "python main.py multi-extract --model llama2-7b \\"
echo "                            --questions-file data/processed/validated_questions.h5 \\"
echo "                            --layer-range 0 10 \\"
echo "                            --batch-size 8 \\"
echo "                            --output-format hdf5"

echo ""
echo "ğŸ“ˆ 4. Complete Pipeline with All New Features"
echo "=============================================="

echo "# Run full pipeline with quality management and interactive visualization"
echo "python main.py pipeline --config enhanced_demo \\"
echo "                        --experimental-features \\"
echo "                        --quality-validation \\"
echo "                        --interactive-dashboard"

echo ""
echo "ğŸ” 5. Analysis with Advanced Features"
echo "====================================="

echo "# Perform advanced analysis on processed activations"
echo "python main.py analyze --input-file data/outputs/activations.h5 \\"
echo "                       --output data/outputs/advanced_analysis \\"
echo "                       --compare-layers transformer.layers.0 transformer.layers.5 transformer.layers.11"

echo ""
echo "# Analyze attention patterns"
echo "python main.py attention --input data/outputs/activations.h5 \\"
echo "                         --output data/outputs/attention_analysis \\"
echo "                         --layer transformer.layers.8"

echo ""
echo "ğŸ“Š 6. Monitoring and Health Checks"
echo "==================================="

echo "# Monitor system performance during processing"
echo "python main.py monitor --interval 30 --duration 300 \\"
echo "                       --output data/outputs/performance_metrics.json"

echo ""
echo "# Validate system setup with new features"
echo "python main.py validate --check-interactive --check-processing --check-gpu"

echo ""
echo "ğŸ“ 7. New File Structure Overview"
echo "=================================="

echo "NeuronMap/"
echo "â”œâ”€â”€ src/"
echo "â”‚   â”œâ”€â”€ data_processing/          # ğŸ†• Data quality and streaming"
echo "â”‚   â”‚   â”œâ”€â”€ quality_manager.py"
echo "â”‚   â”‚   â”œâ”€â”€ streaming_processor.py"
echo "â”‚   â”‚   â””â”€â”€ metadata_manager.py"
echo "â”‚   â”œâ”€â”€ visualization/"
echo "â”‚   â”‚   â”œâ”€â”€ interactive_visualizer.py  # ğŸ†• Enhanced with dashboard"
echo "â”‚   â”‚   â””â”€â”€ visualizer.py"
echo "â”‚   â”œâ”€â”€ analysis/                 # Enhanced multi-model support"
echo "â”‚   â”‚   â”œâ”€â”€ multi_model_extractor.py"
echo "â”‚   â”‚   â”œâ”€â”€ advanced_analysis.py"
echo "â”‚   â”‚   â””â”€â”€ attention_analysis.py"
echo "â”‚   â””â”€â”€ utils/"
echo "â”‚       â””â”€â”€ performance.py       # ğŸ†• Enhanced optimization"
echo "â”œâ”€â”€ data/"
echo "â”‚   â”œâ”€â”€ metadata/                # ğŸ†• Experiment tracking"
echo "â”‚   â”œâ”€â”€ processed/               # ğŸ†• Quality-validated data"
echo "â”‚   â””â”€â”€ outputs/"
echo "â”‚       â”œâ”€â”€ interactive_dashboard/  # ğŸ†• Interactive visualizations"
echo "â”‚       â””â”€â”€ advanced_analysis/      # ğŸ†• Enhanced analysis results"
echo "â””â”€â”€ PHASE2_ENHANCEMENTS.md      # ğŸ†• Comprehensive documentation"

echo ""
echo "âœ… Key Achievements in Phase 2:"
echo "==============================="
echo "â€¢ âœ… Interactive visualization system with Plotly dashboards"
echo "â€¢ âœ… Data quality management and validation framework"
echo "â€¢ âœ… Streaming data processing with async support"
echo "â€¢ âœ… Experiment tracking and metadata management"
echo "â€¢ âœ… Performance optimization and memory management"
echo "â€¢ âœ… Enhanced CLI with 20+ new commands and options"
echo "â€¢ âœ… Comprehensive error handling and monitoring"
echo "â€¢ âœ… HDF5-based efficient data storage"
echo "â€¢ âœ… Multi-threaded and async processing pipelines"
echo "â€¢ âœ… Duplicate detection and data validation"

echo ""
echo "ğŸ¯ Ready for Phase 3:"
echo "===================="
echo "â€¢ Advanced interpretability features (CAVs, saliency maps)"
echo "â€¢ Multi-GPU and distributed computing support"
echo "â€¢ Real-time processing and live visualization"
echo "â€¢ Advanced analytics (probing tasks, RSA, CKA)"
echo "â€¢ Production deployment features"

echo ""
echo "ğŸš€ To get started, run:"
echo "python main.py --help"
echo "python main.py interactive --help"
echo "python main.py process --help"
